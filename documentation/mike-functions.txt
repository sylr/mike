mike-functions(3)
=================

NAME
----
mike-functions - mike's functions

SYNOPSIS
--------
[verse]
              Name              |                                                   Argument data types
--------------------------------+-------------------------------------------------------------------------------------------------------------------------
 __check_order_by_cond          | in_order_by text, in_relname text
 __get_conf                     | in_key text, in_mandatory boolean, in_default text
 __get_conf_array               | in_key text, in_mandatory boolean, in_default text[]
 __get_conf_bigint              | in_key text, in_mandatory boolean, in_default bigint
 __get_conf_bigint_array        | in_key text, in_mandatory boolean, in_default bigint[]
 __get_conf_int                 | in_key text, in_mandatory boolean, in_default integer
 __get_conf_int_array           | in_key text, in_mandatory boolean, in_default integer[]
 __get_id_mimetype              | in_mimetype text, OUT out_id_mimetype smallint
 __get_id_mimetype_stable       | in_mimetype text, OUT out_id_mimetype smallint
 __get_least_used_active_volume | OUT out_id_volume smallint
 __get_mimetype                 | in_id_mimetype smallint
 __make_lot_of_directories      | in_id_user integer, in_level integer, in_nb_by_level integer
 __make_tree                    | in_id_user integer, in_dirs_by_level integer[], in_files_by_level integer[], in_versioning boolean
 __make_tree                    | in_id_user integer, in_nb_level integer, in_inode_by_level integer, in_versioning boolean
 __mod_cons_hash                | in_dividend bigint, in_divisor integer, OUT remainder integer
 __natsort                      | in_text text
 __natsort_asm                  | in_text text
 __natsort_pl                   | in_text text
 __perform                      | in_sql text
 __pg_activity                  | in_datname text
 __pg_locks                     |
 __set_conf                     | in_key text, in_value text
 adduser                        | in_id_user_sso text, in_nickname text, in_state smallint, OUT out_id_user integer
 ls                             | in_id_user integer, in_id_inode bigint
 ls                             | in_id_user integer, in_id_inode bigint, in_limit integer, in_offset integer
 ls                             | in_id_user integer, in_id_inode bigint, in_order_by text
 ls                             | in_id_user integer, in_id_inode bigint, in_order_by text, in_limit integer, in_offset integer
 mkdir                          | in_id_user integer, in_id_inode_parent bigint, in_name text, in_return_if_exists boolean, OUT out_id_inode bigint
 mkdir                          | in_id_user integer, in_name text, OUT out_id_inode bigint
 mvdir                          | in_id_user integer, in_id_inode bigint, in_new_id_inode_parent bigint
 rename                         | in_id_user integer, in_id_inode bigint, in_new_name text
 rmdir                          | in_id_user integer, in_id_inode bigint
 stat                           | in_id_user integer, in_id_inode bigint
 statd                          | in_id_user integer, in_id_inode bigint
 statf                          | in_id_user integer, in_id_inode bigint
 touch                          | in_id_user integer, in_id_inode_parent bigint, in_name text, in_ctime timestamp with time zone, OUT out_id_inode bigint
 xlink                          | in_id_inode bigint, in_id_xfile bigint
 xtouch                         | in_size bigint, in_id_mimetype integer, in_md5 text, in_sha1 text, OUT out_id_xfile bigint, OUT out_id_volume smallint


DESCRIPTION
-----------
List of all functions of Mike's SQL API.

FUNCTIONS
---------

(void) __check_order_by_cond(in_order_by text, in_relname text)::
 +
    Check that a order clause contains columns owned by 'in_relname'.
 +
 +
(mixed) \__get_conf[_*](in_key text, in_mandatory boolean, in_default mixed)::
 +
    Set of functions that retrieve configuration in the conf table and cast it
    as requested.
 +
 +
(smallint) __get_id_mimetype(in_mimetype text)::
 +
    Return the id of a mimetype. If the mimetype does not already exist it create it.
 +
 +
(smallint) __get_id_mimetype_stable(in_mimetype text)::
 +
    Return the id of a mimetype.
 +
 +
(smallint) __get_least_used_active_volume()::
 +
    Return the id of the least used active volume.
 +
 +
(text) __get_mimetype(smallint)::
 +
    Return mimetype label.
 +
 +
(integer) __mod_cons_hash(in_dividend bigint, in_divisor integer)::
 +
    Basic consistent hash function using modulus.
 +
 +
(text) __natsort(in_text)::
 +
    Rewrite input to do natural sorting. It left pads any suite of numbers with 0
    in order to be able to sort string naturally.
-------------------
__natsort('file-15.sql')   = 'file-000000000015.sql'
__natsort('file-1589.sql') = 'file-000000001589.sql'
-------------------

(text) __natsort_asm(in_text)::
 +
    natsort version written in ASM.
 +
 +
(text) __natsort_pl(in_text)::
 +
    natsort version written in Perl.
(integer) adduser(in_id_user_sso, in_nickname, in_state)::
 +
    Add a user.
 +
 +
(inode_full_t) ls(in_id_user integer, in_id_inode bigint)::
 +
    List a directory with natsorting.
    See linkmike:mike-types[3].
 +
 +
(inode_full_t) ls(in_id_user integer, in_id_inode bigint, in_limit, in_offset)::
 +
    List a directory with natsorting and paging.
    See linkmike:mike-types[3].
 +
 +
(inode_full_t) ls(in_id_user integer, in_id_inode bigint, in_order_by)::
 +
    List a directory with custom sorting.
    See linkmike:mike-types[3].
 +
 +
(inode_full_t) ls(in_id_user integer, in_id_inode bigint, in_order_by, in_limit, in_offset)::
 +
    List a directory with custom sorting and paging.
    See linkmike:mike-types[3].
 +
 +
(bigint) mkdir(in_id_user, in_id_inode_parent, in_name)::
 +
    Create a directory inside another directory.
 +
 +
(bigint) mkdir(in_id_user, in_name)::
 +
    Create a directory at vfs's root.
 +
 +
(void) mvdir(in_id_user, in_id_inode, in_new_id_inode_parent)::
 +
    Move a directory inside another directory.
 +
 +
(void) rename(in_id_user, in_id_inode, in_new_name)::
 +
    Rename an inode.
 +
 +
(void) rmdir(in_id_user, in_id_inode)::
 +
    Flag a directory and its children for removal.
 +
 +
(bigint) touch(in_id_user bigint, in_id_inode_parent bigint, in_name text, in_ctime timestamptz)::
 +
    Create a file record.
 +
 +
(void) xlink(in_id_inode bigint, in_id_xfile bigint)::
 +
    Link a xfile record to a file one. It basically creates a record in the table
    'as_file_xfile' and updates the file record with the data of the xfile record.
 +
 +
(record) xtouch(in_size bigint, in_id_mimetype integer, in_md5 text, in_sha1 text)::
 +
    Create a xfile record.
    'in_md5' and 'in_sha1' are optional parameters.

Authors
-------
Written by Sylvain Rabot <sylvain@abstraction.fr>

MIKE
----
Part of the linkmike:mike[3] suite.
